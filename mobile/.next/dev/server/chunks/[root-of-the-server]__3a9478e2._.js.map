{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/rixinpeng/Documents/GitHub/TravelPlanner-AntiG/proxy.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\n\nconst ACCESS_TOKEN_COOKIE = \"sb-access-token\";\n\nexport function proxy(request: NextRequest) {\n    const { pathname } = request.nextUrl;\n    const accessToken = request.cookies.get(ACCESS_TOKEN_COOKIE)?.value;\n\n    const isProtectedPage = pathname.startsWith(\"/dashboard\") || pathname.startsWith(\"/trip/\");\n    const isTripsApi = pathname.startsWith(\"/api/trips\");\n    const isLoginPage = pathname === \"/login\";\n\n    if (!accessToken && isProtectedPage) {\n        return NextResponse.redirect(new URL(\"/login\", request.url));\n    }\n\n    if (!accessToken && isTripsApi) {\n        return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n    }\n\n    if (accessToken && isLoginPage) {\n        return NextResponse.redirect(new URL(\"/dashboard\", request.url));\n    }\n\n    return NextResponse.next();\n}\n\nexport const config = {\n    matcher: [\"/dashboard/:path*\", \"/trip/:path*\", \"/login\", \"/api/trips/:path*\"],\n};\n"],"names":["NextResponse","ACCESS_TOKEN_COOKIE","proxy","request","pathname","nextUrl","accessToken","cookies","get","value","isProtectedPage","startsWith","isTripsApi","isLoginPage","redirect","URL","url","json","error","status","next","config","matcher"],"mappings":";;;;;;AAAA,OAAsBA,YAAY,KAAQ,aAAa;;AAEvD,KAAM,CAAAC,mBAAmB,GAAG,iBAAiB,CAE7C,MAAO;AAAA,QAAS,CAAAC,KAAKA,CAACC,OAAoB,CAAE;IACxC,MAAM,EAAEC,QAAS,EAAC,GAAGD,OAAO,CAACE,OAAO;IACpC,KAAM,CAAAC,WAAW,GAAGH,OAAO,CAACI,OAAO,CAACC,GAAG,CAACP,mBAAmB,CAAC,EAAEQ,KAAK;IAEnE,KAAM,CAAAC,eAAe,GAAGN,QAAQ,CAACO,UAAU,CAAC,YAAY,CAAC,IAAIP,QAAQ,CAACO,UAAU,CAAC,QAAQ,CAAC;IAC1F,KAAM,CAAAC,UAAU,GAAGR,QAAQ,CAACO,UAAU,CAAC,YAAY,CAAC;IACpD,KAAM,CAAAE,WAAW,GAAGT,QAAQ,KAAK,QAAQ;IAEzC,IAAI,CAACE,WAAW,IAAII,eAAe,EAAE;QACjC,MAAO,CAAAV,8IAAY,CAACc,QAAQ,CAAC,GAAI,CAAAC,GAAG,CAAC,QAAQ,EAAEZ,OAAO,CAACa,GAAG,CAAC,CAAC;IAChE;IAEA,IAAI,CAACV,WAAW,IAAIM,UAAU,EAAE;QAC5B,MAAO,CAAAZ,8IAAY,CAACiB,IAAI,CAAC;YAAEC,KAAK,EAAE;QAAe,CAAC,EAAE;YAAEC,MAAM,EAAE;QAAI,CAAC,CAAC;IACxE;IAEA,IAAIb,WAAW,IAAIO,WAAW,EAAE;QAC5B,MAAO,CAAAb,8IAAY,CAACc,QAAQ,CAAC,GAAI,CAAAC,GAAG,CAAC,YAAY,EAAEZ,OAAO,CAACa,GAAG,CAAC,CAAC;IACpE;IAEA,MAAO,CAAAhB,8IAAY,CAACoB,IAAI,CAAC,CAAC;AAC9B,CAEA,MAAO;AAAA,KAAM,CAAAC,MAAM,GAAG;IAClBC,OAAO,EAAE;QAAC,mBAAmB;QAAE,cAAc;QAAE,QAAQ;QAAE,mBAAmB;;AAChF,CAAC","ignoreList":[]}}]
}